{"id":"dave.html","dependencies":[{"name":"/Users/apple/Downloads/Todo_Rest_CRUD_Application_JQuery_FetchAPI-master/package.json","includedInParent":true,"mtime":1556021382752}],"generated":{"html":"<!doctype html>\n<html lang=\"en\">\n  <head>\n    <!-- Required meta tags -->\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n\n    <!-- Bootstrap CSS -->\n    <link rel=\"stylesheet\" href=\"https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css\" integrity=\"sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO\" crossorigin=\"anonymous\">\n\n    <title>Todo Crud Application</title>\n  </head>\n  <body>\n    <div class=\"container\">\n        <div class=\"row\">\n            <div class=\"col-lg-2\"></div>\n            <div class=\"col-lg-8\">\n                <button class=\"btn btn-primary\" id=\"timer\">winner</button>                \n\n                <ul class=\"list-group\" id=\"display\">\n                </ul>\n            </div>\n            <div class=\"col-lg-2\"></div>\n        </div> \n        <br>\n        <div class=\"row\">\n            <div class=\"col-lg-2\"></div>\n            <div class=\"col-lg-8\">\n                <div class=\"alert\" role=\"alert\" id=\"message\">\n                    \n                </div>\n            </div>\n            <div class=\"col-lg-2\"></div>\n        </div>\n\n\n        <div class=\"row\">\n            <div class=\"col-lg-2\"></div>\n            <div class=\"col-lg-8\">\n                <form id=\"form\">\n                    <div class=\"form-group\" id=\"userInfo\">\n                        <label for=\"phone\">phone +62</label>\n                        <input class=\"form-control\" id=\"phoneUserInput\" type=\"tel\" name=\"phone\" placeholder=\"81386139021\">\n\n\n                        <label for=\"phone\">name </label>\n                        <input class=\"form-control\" id=\"nameUserInput\" type=\"text\" name=\"name\" placeholder=\"name\">\n\n\n                       \n                        <button id=\"join\" type=\"submit\" class=\"btn btn-primary\">join</button>\n                    </div>\n                    \n                </form>\n\n            </div>\n            <div class=\"col-lg-2\"></div>\n        </div>\n\n        <div class=\"row\" id=\"imgContainer\"></div>\n\n           \n    </div>\n\n\n\n    <!-- Optional JavaScript -->\n    <!-- jQuery first, then Popper.js, then Bootstrap JS -->\n<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js\"></script>\n\n\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js\"></script>\n    <script>var server = '';\n\"use strict\";\n\n$(document).ready(function () {\n  var display = $(\"#display\");\n  var message = $(\"#message\");\n  var form = $(\"#form\");\n  var phoneUserInput = $(\"#phoneUserInput\");\n  var join = $(\"#join\");\n  var timer = $(\"#timer\");\n  message.hide();\n\n  var displayMessage = function displayMessage(flag, msg) {\n    message.removeClass('alert-danger');\n    message.addClass('alert-success');\n    message.html(msg);\n    message.show();\n  };\n\n  function getQueryVariable(variable) {\n    var query = window.location.search.substring(1);\n    var vars = query.split(\"&\");\n\n    for (var i = 0; i < vars.length; i++) {\n      var pair = vars[i].split(\"=\");\n\n      if (pair[0] == variable) {\n        return pair[1];\n      }\n    }\n\n    return false;\n  }\n\n  var t = getQueryVariable(\"t\") ? getQueryVariable(\"t\") : '5cc849d7ec37e375be625556';\n  $.ajax({\n    type: \"POST\",\n    url: server + \"/getT\",\n    data: JSON.stringify({\n      t: t\n    }),\n    contentType: \"application/json; charset=utf-8\",\n    crossDomain: true,\n    dataType: \"json\",\n    success: function success(data, status, jqXHR) {\n      for (var i = 0; i < data.imgUrl.length; i++) {\n        $(\"#imgContainer\").append(\"<img src=\\\"\".concat(data.imgUrl[i], \"\\\" alt=\\\"\\\">\"));\n      }\n\n      for (var _i = 0; _i < data.videoUrl.length; _i++) {\n        $(\"#imgContainer\").append(\"<iframe width=\\\"560\\\" height=\\\"315\\\" src=\\\"\".concat(data.videoUrl[_i], \"\\\" frameborder=\\\"0\\\" allow=\\\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\\\" allowfullscreen></iframe>\"));\n      }\n\n      var diffSecond = data.diffSecond;\n      startCount(diffSecond);\n      var id = setInterval(function () {\n        diffSecond--;\n        console.log(diffSecond);\n\n        if (diffSecond >= 0) {\n          var offset = moment.duration(diffSecond, 'seconds');\n          var month = offset.months();\n          var day = offset.days();\n          var hour = offset.hours();\n          var minute = offset.minutes();\n          var second = offset.seconds();\n          var diff = moment({\n            month: month,\n            day: day,\n            hour: hour,\n            minute: minute,\n            second: second\n          });\n          $(\"#timer\").html(diff.format(\"HH:mm:ss\"));\n        } else {\n          //时间到\n          clearInterval(id);\n          $.ajax({\n            type: \"POST\",\n            url: server + \"/hit\",\n            data: JSON.stringify({\n              t: t\n            }),\n            contentType: \"application/json; charset=utf-8\",\n            crossDomain: true,\n            dataType: \"json\",\n            success: function success(data, status, jqXHR) {\n              if (data.m.length < 10) {\n                //时间到，人未满\n                $(\"#timer\").html('Game Over'); // $(\"#userInfo\").hide()\n              } else {\n                //时间到，且人数满\n                $.ajax({\n                  type: \"POST\",\n                  url: server + \"/davec\",\n                  data: JSON.stringify({\n                    t: t\n                  }),\n                  contentType: \"application/json; charset=utf-8\",\n                  crossDomain: true,\n                  dataType: \"json\",\n                  success: function success(data, status, jqXHR) {\n                    $(\"#timer\").html(data.memberPhone);\n                  }\n                });\n              }\n            }\n          });\n        }\n      }, 1000);\n    },\n    error: function error(jqXHR, status) {\n      // error handler\n      console.log(jqXHR);\n      console.log('fail' + status.code);\n    }\n  }); //倒计时开奖\n\n  function startCount(diffSecond) {\n    console.log(diffSecond);\n\n    if (diffSecond >= 0) {\n      var offset = moment.duration(diffSecond, 'seconds');\n      var month = offset.months();\n      var day = offset.days();\n      var hour = offset.hours();\n      var minute = offset.minutes();\n      var second = offset.seconds();\n      var diff = moment({\n        month: month,\n        day: day,\n        hour: hour,\n        minute: minute,\n        second: second\n      });\n      $(\"#timer\").html(diff.format(\"HH:mm:ss\"));\n    } else {\n      //时间到\n      $.ajax({\n        type: \"POST\",\n        url: server + \"/hit\",\n        data: JSON.stringify({\n          t: t\n        }),\n        contentType: \"application/json; charset=utf-8\",\n        crossDomain: true,\n        dataType: \"json\",\n        success: function success(data, status, jqXHR) {\n          if (data.m.length < 10) {\n            //时间到，人未满\n            $(\"#timer\").html('Game Over'); // $(\"#userInfo\").hide()\n          } else {\n            //时间到，且人数满\n            $.ajax({\n              type: \"POST\",\n              url: server + \"/davec\",\n              data: JSON.stringify({\n                t: t\n              }),\n              contentType: \"application/json; charset=utf-8\",\n              crossDomain: true,\n              dataType: \"json\",\n              success: function success(data, status, jqXHR) {\n                $(\"#timer\").html(data.memberPhone);\n              }\n            });\n          }\n        }\n      });\n    }\n  }\n\n  function getTodos() {\n    $.ajax({\n      type: \"POST\",\n      url: server + \"/hit\",\n      data: JSON.stringify({\n        t: t\n      }),\n      contentType: \"application/json; charset=utf-8\",\n      crossDomain: true,\n      dataType: \"json\",\n      success: function success(data, status, jqXHR) {\n        if (data.m.length < 10) {\n          display.append(\"<div>captain \".concat(data.t, \" </div>\"));\n          display.append(\"<div>need \".concat(10 - data.m.length, \" more</div>\"));\n          displayTodos(data);\n        } else {\n          if (data.haveWinner) {\n            timer.html(data.haveWinner.memberPhone);\n          }\n\n          display.append(\"<div>captain \".concat(data.t, \" </div>\"));\n          display.append(\"<div>full</div>\"); // $(\"#userInfo\").hide()\n\n          displayTodos(data);\n        }\n      }\n    });\n  }\n\n  getTodos();\n\n  function validatePhone(phone) {\n    var re = /^[0-9]{11}$/;\n    return re.test(phone);\n  }\n\n  form.submit(function (e) {\n    e.preventDefault();\n\n    if (validatePhone($('#phoneUserInput').val())) {\n      $.ajax({\n        type: \"POST\",\n        url: server + \"/davet\",\n        data: JSON.stringify({\n          t: t,\n          memberPhone: phoneUserInput.val(),\n          memberName: $('#nameUserInput').val()\n        }),\n        contentType: \"application/json; charset=utf-8\",\n        crossDomain: true,\n        dataType: \"json\",\n        success: function success(data, status, jqXHR) {\n          console.log(data);\n\n          if (data.full) {\n            window.location.href = data.msg;\n          } else {\n            displayMessage(true, data.msg);\n            display.empty();\n            getTodos();\n          }\n        }\n      });\n    }\n  }); // const displayTodos = (data)=>{\n  //     data.m.forEach((todo)=>{\n  //         display.append(\n  //             `<li class=\"list-group-item\" id=\"\">\n  //                 <div class=\"row\">\n  //                     <div class=\"col-md-4\" id=\"\">${todo.memberPhone}</div>\n  //                     <div class=\"col-md-4\">${todo.memberName}</div>\n  //                 </div>\n  //            </li>`);\n  //     });\n  // }\n\n  var displayTodos = function displayTodos(data) {\n    data.m.forEach(function (todo) {\n      display.append(\"<li class=\\\"list-group-item\\\" id=\\\"\\\">\\n                            <div class=\\\"row\\\">\\n                                <div class=\\\"col-md-4\\\" id=\\\"\\\">\".concat(todo.memberPhone, \"</div>\\n                                <div class=\\\"col-md-4\\\">\").concat(todo.memberName, \"</div>\\n                            </div>\\n                       </li>\"));\n    });\n  };\n});</script>\n</body>\n</html>"},"sourceMaps":null,"error":null,"hash":"03bbf83dc9346d04f5dca46a2d313a3b","cacheData":{"env":{}}}